# Installation
This document describes how to get EJScreen running locally on your own computer.

There are probably many ways to do this. Here's one that works:

- EJScreen is built using the ASP.NET 4.8 framework. That requires a Windows machine.
- Pull this repo using your preferred method (e.g. Github Desktop, `git`). If you're not working on an established branch, it's advisable to create one (see EDGI's contributing guidelines [here](https://github.com/edgi-govdata-archiving/overview/blob/main/CONTRIBUTING.md)). A branch is a way to develop and test code without overwriting the "official" main version of the code. Eventually, edits on your branch can be merged or "pulled" into the main branch using a "pull request."
- In terms of editing the code, Visual Studio Code integrates well with Github and ASP.NET 4.8. 
- Download and open VS Code. ASP.NET 4.8 sites require an IIS server. Maybe the easiest way to work with it is to install the "[IIS Express[(https://github.com/warrenbuckley/IIS-Express-Code)" extension to VS Code, enabling you to start/stop/restart the server from within the editor. In the "Extensions" menu of VS Code (Ctrl-Shift-X), search for "IIS Express."
- Here's where it gets complicated :) Because I'm a bad programmer, I replaced a lot of relative references to `mapdijit` modules with absolute paths. Some of the HTML and JS files in your repo will include calls to `http://pedp-ejscreen.azurewebsites.net/mapdijit/...` which won't work locally because of CORS. You will need to replace these absolute references to scripts with other absolute references, using `http://localhost:8000/` in place of `http://pedp-ejscreen.azurewebsites.net/`. (Or, you could just fix this issue - you shouldn't have to make absolute references at all. See issue [#19](https://github.com/edgi-govdata-archiving/EJScreen/issues/19)). There are too many of these references, randomly scattered throughout the code, to adjust by hand. You can quickly do this with a Linux shell by navigating to the EJScreen directory where you are developing and doing `sed -i -e 's/https:\/\/pedp-ejscreen.azurewebsites.net/http:\/\/localhost:8000/' */*.js *.html` But if you're on Windows, this wont' work unless you install some ports of Linux tools. See [here](https://stackoverflow.com/a/62397611/6872248) for instancee.
- At this point, you can now run IIS Express by doing Ctrl-Shift-P to access the VS Code commands. Then search for IIS Express: Start Website.
- IIS Express will create a configuration json for your version of EJScreen (`iisexpress.json`, available from the `.vscode` folder).
- Be sure to edit the `port` value to 8000 to match the `http://localhost:8000` path mentioned above.
- After making changes to the code and before making a pull request, please try to do the reverse, replacing the `http://localhost:8000` references with the `http://pedp-ejscreen.azurewebsites.net` references.